log.z <- log(z)
#help(pressure)
x <- pressure$temperature
z <- pressure$pressure
plot(x, z)
plot(x, log(z))
log.z <- log(z)
a.hat <- mean(log.z)
b.hat <- cov(x,log.z)/var(x)
x.bar <- mean(x)
plot(x, z, xlab="temperature", ylab="vapor pressure")
uncomment the next two lines to add the curve to the scatterplot
plot(x, z, xlab="temperature", ylab="vapor pressure")
#uncomment the next two lines to add the curve to the scatterplot
grid <- seq(min(x), max(x), length.out=100)
lines(grid, exp(a.hat + b.hat*(grid - x.bar)), col="red")
a.hat <- mean(log.z)
b.hat <- cov(x,log.z)/var(x)
x.bar <- mean(x)
180*0.04
1.094 - 7.2
plot(x, log.z, xlab="temperature", ylab="log of vapor pressure")
#uncomment the next two lines to add the line to the scatterplot
hat0 <- a.hat - b.hat*x.bar # intercept
abline(b.hat0, b.hat, col="red")
plot(x, log.z, xlab="temperature", ylab="log of vapor pressure")
#uncomment the next two lines to add the line to the scatterplot
b.hat0 <- a.hat - b.hat*x.bar # intercept
abline(b.hat0, b.hat, col="red")
M <- cbind(1, x, x^2)
decop = svd(M)
decop$d
M <- cbind(1, x, x^2)
decop = svd(M)
diag(decop$d ** 2)
M <- cbind(1, x, x^2)
decop = svd(M)
pred_lz = decop$v %*% diag((1/decop$d) ** 2) %*% t(decop$v) %*% t(M) %*% log.z
pred_lz
M <- cbind(1, x, x^2)
decop = svd(M)
C= decop$v %*% diag((1/decop$d) ** 2) %*% t(decop$v) %*% t(M) %*% log.z
C
plot(x, log.z, xlab="temperature", ylab="log of vapor pressure")
plot(x, log.z, xlab="temperature", ylab="log of vapor pressure")
grid <- seq(min(x), max(x), length.out=100)
lines(grid, -7.995 + 7.38*grid -9.447*(grid^2), col="red")
c[2]
M <- cbind(1, x, x^2)
decop = svd(M)
C= decop$v %*% diag((1/decop$d) ** 2) %*% t(decop$v) %*% t(M) %*% log.z
C[2]
M <- cbind(1, x, x^2)
decop = svd(M)
C= decop$v %*% diag((1/decop$d) ** 2) %*% t(decop$v) %*% t(M) %*% log.z
C[3]
M <- cbind(1, x, x^2)
decop = svd(M)
C= decop$v %*% diag((1/decop$d) ** 2) %*% t(decop$v) %*% t(M) %*% log.z
C[3]
M <- cbind(1, x, x^2)
decop = svd(M)
C= decop$v %*% diag((1/decop$d) ** 2) %*% t(decop$v) %*% t(M) %*% log.z
C[3]
M <- cbind(1, x, x^2)
decop = svd(M)
C= decop$v %*% diag((1/decop$d) ** 2) %*% t(decop$v) %*% t(M) %*% log.z
C
M <- cbind(1, x, x^2)
decop = svd(M)
C= decop$v %*% diag((1/decop$d) ** 2) %*% t(decop$v) %*% t(M) %*% log.z
C
M <- cbind(1, x, x^2)
decop = svd(M)
C= decop$v %*% diag((1/decop$d) ** 2) %*% t(decop$v) %*% t(M) %*% log.z
C[2]
plot(x, log.z, xlab="temperature", ylab="log of vapor pressure")
grid <- seq(min(x), max(x), length.out=100)
lines(grid, -7.995 + 0.074*grid -0.0000945*(grid^2), col="red")
plot(x, z, xlab="temperature", ylab="vapor pressure")
grid <- seq(min(x), max(x), length.out=100)
lines(grid, exp(-7.995 + 0.074*grid -0.0000945*(grid^2)), col="red")
max(x)
plot(x, z, xlab="temperature", ylab="vapor pressure")
grid <- seq(0, 500, length.out=100)
lines(grid, exp(-7.995 + 0.074*grid -0.0000945*(grid^2)), col="red")
plot(x, z, xlab="temperature", ylab="vapor pressure")
grid <- seq(0, 500, length.out=100)
lines(grid, exp(-7.995 + 0.074*grid -0.0000945*(grid^2)), col="red",xlim=c(0,500))
plot(x, z, xlab="temperature", ylab="vapor pressure",xlim=c(0,500))
grid <- seq(0, 500, length.out=100)
lines(grid, exp(-7.995 + 0.074*grid -0.0000945*(grid^2)), col="red")
plot(x, z, xlab="temperature", ylab="vapor pressure",xlim=c(0,500))
grid <- seq(0, 500, length.out=100)
lines(grid, exp(-7.995 + 0.074*grid +0.0000945*(grid^2)), col="red")
plot(x, z, xlab="temperature", ylab="vapor pressure",xlim=c(0,500))
grid <- seq(0, 500, length.out=100)
lines(grid, exp(-7.995 + 0.074*grid -0.0000945*(grid^2)), col="red")
expo = lm(log.z ~x)
plot(x, z, xlab="temperature", ylab="vapor pressure",xlim=c(0,500))
grid <- seq(0, 500, length.out=100)
lines(grid, exp(predict(expo,grid)), col="red")
expo = lm(log.z ~x)
plot(x, z, xlab="temperature", ylab="vapor pressure",xlim=c(0,500))
grid <- seq(0, 500, length.out=100)
lines(grid, exp(predict(expo,grid)), col="red")
predict(expo,grid)
predict(expo,list(grid))
expo = lm(log.z ~x)
plot(x, z, xlab="temperature", ylab="vapor pressure",xlim=c(0,500))
grid <- seq(0, 500, length.out=100)
pred = predict(expo,list(grid))
lines(grid, exp(pred), col="red")
expo = lm(log.z ~x)
plot(x, z, xlab="temperature", ylab="vapor pressure",xlim=c(0,500))
grid <- seq(0, 500, length.out=100)
lines(grid, exp(predict(expo,list(grid))), col="red")
length(grid)
length(exp)
length(exp(predict(expo,list(grid))))
predict(expo,list(grid))
list(grid)
predict(expo,2)
x
log.z
data = cbind(log.z,x)
expo = lm(log.z ~x,data=data)
data = as.data.frame(cbind(log.z,x))
expo = lm(log.z ~x,data=data)
plot(x, z, xlab="temperature", ylab="vapor pressure",xlim=c(0,500))
grid <- seq(0, 500, length.out=100)
lines(grid, exp(predict(expo,list(grid))), col="red")
View(data)
predict(expo,2)
expo
predict(lm(log.z ~x),2)
?predict
predict.lm(expo,2)
plot(predict.lm(expo,1))
plot(predict(lm(log.z ~x),2))
plot(predict(lm(log.z ~x),newdata = 2))
library(devtools)
use_vignette()
setwd('/Users/bo/Desktop/2020 fall/Computational/homework-1/bis557')
use_vignette()
use_vignette('HW2')
